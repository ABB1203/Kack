package game.entity.mob;

import game.gfx.Screen;
import game.gfx.Sprite;
import game.input.InputHandler;
import game.input.Mouse;
import game.weapon.Weapon;

public class Player extends Mob {

	private InputHandler input;
	private Sprite sprite = Sprite.leaves;

	public Player(InputHandler input, Weapon weapon) {
		this.input = input;
		this.weapon = weapon;
	}

	public void tick(int xOffset, int yOffset) {
		int xDir = 0;
		int yDir = 0;
		
		if (input.up) yDir--;
		if (input.down) yDir++;
		if (input.right) xDir++;
		if (input.left) xDir--;
		
		move(xDir, yDir);
		
		if (x < 0) x = 0;
		if (y < 0) y = 0;
		if (x > level.getWidth() - sprite.getSize()) x = level.getWidth() - sprite.getSize();
		if (y > level.getHeight() - sprite.getSize()) y = level.getHeight() - sprite.getSize();
		
		updateShooting(xOffset, yOffset);
	}
	
	private void updateShooting(int xOffset, int yOffset) {
		if(Mouse.getButton() == 1) {
			double dx = Mouse.getX() - x + getSprite().getSize() / 2 - xOffset;
			double dy = Mouse.getY() - y + getSprite().getSize() / 2 - yOffset;
			
			angle = Math.atan2(dx, dx);
		}
	}

	public void render(Screen screen) {
		screen.renderPlayer(x, y, this);
	}

	public int getX() {
		return x;
	}

	public int getY() {
		return y;
	}

	public Sprite getSprite() {
		return sprite;
	}
}
